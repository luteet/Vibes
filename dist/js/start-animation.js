import customMouse from"./mouse.js";import scrollAnimation from"./scroll-animation.js";export default function startAnimation(e){function t(e){let t=e.getBoundingClientRect();return{top:t.top+window.scrollY,right:t.right+window.scrollX,bottom:t.bottom+window.scrollY,left:t.left+window.scrollX}}gsap.set(document.querySelector("html"),{"--background-color":"rgb(3,3,4)","--theme-color-1":"rgb(245,248,255)","--theme-color-1-reverse":"rgb(3,3,4)","--theme-switch":0});const o=document.querySelectorAll(".hero__decor_element"),r=document.querySelector(".hero__title"),i=document.querySelector(".hero__mob_title"),n=document.querySelector(".hero__text"),s=document.querySelector(".loader");history.scrollRestoration="manual",gsap.registerPlugin(ScrollTrigger),ScrollTrigger.config({ignoreMobileResize:!0});const a=gsap.timeline({duration:2,ease:"power2.inOut"});a.pause();let l=gsap.matchMedia();l.add("(min-width: 992px)",()=>{let i=new Lenis({wrapper:window,container:document.body});function l(e){i.raf(e),requestAnimationFrame(l)}i.stop(),document.querySelectorAll(".split-lines").forEach(e=>{new SplitType(e,{types:"lines"})}),gsap.set(s,{right:"50%"}),gsap.set(r,{"--x-1":"120%","--x-2":"-120%","--x-3":"120%"}),gsap.set(o[0],{"--y":"-150%","--x":"45%"}),gsap.set(o[1],{"--y":"150%","--x":"-40%"}),gsap.set(n,{"--x":"200%"}),a.to(s,{right:"23.5vw",duration:2,ease:"power2.inOut",onStart:()=>e.header.classList.add("is-loaded")},"-=1"),a.to(o[0],{"--y":"0%",duration:2,ease:"power2.inOut"},"-=2.5"),a.to(o[1],{"--y":"25%",duration:2,ease:"power2.inOut"},"-=2.5"),a.to(r,{"--x-1":"0%","--x-2":"0%","--x-3":"0%",duration:3,ease:"power3.inOut"},"-=2.5"),a.to(n,{"--x":"0%",duration:3,ease:"power3.inOut",onComplete:()=>{setTimeout(()=>{i.destroy(),i=new Lenis({wrapper:window,container:document.body}),requestAnimationFrame(l),i.on("scroll",e=>{ScrollTrigger.update()}),document.body.classList.add("is-loaded"),document.querySelectorAll(".prototypes__container").forEach(e=>{let t=new Lenis({wrapper:e,content:e});const o=e.querySelectorAll(".prototypes__block"),r=e.querySelectorAll(".prototypes__nav_list a");r.forEach(o=>{o.addEventListener("click",r=>{r.preventDefault(),t.scrollTo(e.querySelector(o.getAttribute("href")))})}),t.on("scroll",e=>{o.forEach((e,t)=>{e.getBoundingClientRect().top>0&&e.getBoundingClientRect().top<window.innerHeight/4&&!r[t].classList.contains("is-active")&&(o.forEach(e=>e.classList.remove("is-active")),e.classList.add("is-active"),r.forEach(e=>e.classList.remove("is-active")),r[t].classList.add("is-active"))})}),requestAnimationFrame((function e(o){t.raf(o),requestAnimationFrame(e)}))}),document.querySelectorAll(".header__nav_list a").forEach(e=>{e.addEventListener("click",o=>{o.preventDefault();const r=t(document.querySelector(e.getAttribute("href"))).top;"#cases-section"==e.getAttribute("href")?i.scrollTo(r-window.innerHeight/2):i.scrollTo(r)})}),scrollAnimation({lenis:i}),customMouse()},0)}},"-=3");const d=gsap.timeline();d.pause(),gsap.set(s,{"--background-1":"235deg","--background-2":"270deg","--opacity":"0"}),d.to(s,{"--background-1":"90deg",duration:1,onComplete:()=>{gsap.set(s,{"--opacity":"1"}),d.pause()}}),d.resume(),window.addEventListener("load",()=>{history.scrollRestoration="manual",document.body.classList.add("is-init"),d.to(s,{"--background-2":"465deg",duration:1,onComplete:()=>{a.resume()}}),setTimeout(()=>{d.resume()},1200),gsap.to(e.header,{transform:"translate3d(0,0,0)",duration:2,delay:2,ease:"power2.inOut"})})}),l.add("(max-width: 991px)",()=>{const r=gsap.timeline({defaults:{duration:2,ease:"power2.inOut"}});var a;r.pause(),gsap.set(document.body,{overflow:"hidden"}),gsap.set(s,{right:"50%",top:"50%"}),gsap.set(o[0],{"--y":"-150%","--x":"-105%"}),gsap.set(o[1],{"--y":"100%","--x":"100%"}),r.to(s,{right:"50%",top:t(i).top-s.offsetHeight+"px",duration:2,onStart:()=>e.header.classList.add("is-loaded")}),r.to(o[0],{"--y":(a=10,.01*window.innerHeight*a)+"px","--x":"5vw",duration:2,ease:"power2.inOut"},"-=1"),r.to(o[1],{"--y":"0vh","--x":"0vw",duration:2,ease:"power2.inOut"},"-=2"),r.to(i,{opacity:1,duration:3,ease:"power3.inOut"},"-=2.5"),r.to(n,{opacity:1,duration:3,ease:"power3.inOut",onComplete:()=>{setTimeout(()=>{document.body.classList.add("is-loaded"),document.body.style.removeProperty("overflow"),document.querySelectorAll(".header__nav_list a").forEach(o=>{o.addEventListener("click",r=>{r.preventDefault(),e.menu.forEach(e=>{e.classList.remove("is-mobile-menu-active")});const i=t(document.querySelector(o.getAttribute("href"))).top;"#cases-section"==o.getAttribute("href")?window.scrollTo({left:0,top:i-window.innerHeight/2,behavior:"smooth"}):window.scrollTo({left:0,top:i,behavior:"smooth"})})}),scrollAnimation()},0)}},"-=3");const l=gsap.timeline();l.pause(),gsap.set(s,{"--background-1":"235deg","--background-2":"270deg","--opacity":"0"}),l.to(s,{"--background-1":"90deg",duration:1,onComplete:()=>{gsap.set(s,{"--opacity":"1"}),l.pause()}}),l.resume(),window.addEventListener("load",()=>{history.scrollRestoration="manual",document.body.classList.add("is-init"),l.to(s,{"--background-2":"465deg",duration:1,onComplete:()=>{r.resume()}}),setTimeout(()=>{l.resume()},1200),gsap.to(e.header,{transform:"translate3d(0,0,0)",duration:2,delay:2,ease:"power2.inOut"})})})}